:root{
  --bg:#f6f7fb; --card:#fff; --ink:#111827; --muted:#6b7280; --line:#e5e7eb;
  --accent:#0ea5e9; --ok:#16a34a; --bad:#ef4444;
  --p1:#e9f5e9; --p2:#eaf1ff; --sum:#fdebdc; --avg:#fff6cf; --final:#ffd7dc; --total:#efefef;
  --printScale: 1;
}
*{box-sizing:border-box}
html,body{margin:0; width:100%; max-width:100%; overflow-x:hidden; font-family:"Cairo",system-ui}
body{background:var(--bg); color:var(--ink)}
h1{margin:0; font-size:18px}
.sub{font-size:12px;color:var(--muted);margin-top:2px}
.topbar{padding:16px; display:flex; gap:12px; justify-content:space-between; flex-wrap:wrap; align-items:center}
.title{display:flex; gap:10px; align-items:center}
.badge{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;color:#fff;font-weight:900;
  background:linear-gradient(135deg,#22c55e,#0ea5e9)}
.top-actions{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
button{border:1px solid var(--line); background:#fff; padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:900}
button.primary{background:var(--accent); border-color:var(--accent); color:#fff}
button.danger{background:var(--bad); border-color:var(--bad); color:#fff}
.pill{display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px; border:1px solid var(--line); background:#fff; font-size:12px; color:var(--muted); font-weight:900}
.dot{width:10px;height:10px;border-radius:50%}
.dot.ok{background:var(--ok)} .dot.bad{background:var(--bad)} .dot.neu{background:#f59e0b}

.layout{padding:0 16px 16px; display:grid; grid-template-columns:390px 1fr; gap:12px}
@media (max-width:980px){.layout{grid-template-columns:1fr}}
.card{background:var(--card); border:1px solid var(--line); border-radius:14px; overflow:hidden}
.card-hd{padding:12px; border-bottom:1px solid var(--line); display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; align-items:center}
.hd-title{font-weight:900}
.card-bd{padding:12px}
label{display:block;font-size:12px;color:var(--muted);margin:8px 0 6px;font-weight:900}
input,select,textarea{width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--line); font-family:inherit; font-size:13px}
textarea{min-height:90px; resize:vertical}
.row{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:8px}
.row3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-top:8px}
@media (max-width:980px){.row,.row3{grid-template-columns:1fr}}

.hint{margin-top:8px; color:var(--muted); font-size:12px; line-height:1.6}
hr{border:none;border-top:1px solid var(--line); margin:12px 0}

#printArea{background:#fff}
.wrapX{width:100%; overflow:auto; -webkit-overflow-scrolling:touch}
table{width:100%; border-collapse:collapse; font-size:12px; table-layout:fixed; min-width:900px}
th,td{border:1px solid #111; padding:6px; text-align:center; vertical-align:middle; word-break:break-word}
th{font-weight:900}
.namecell{text-align:right; font-weight:900}
.inline-input{width:100%; padding:6px; border:1px solid #000; border-radius:6px; font-size:12px; font-family:inherit}
.inline-input.name{text-align:right;font-weight:900}
.inline-input.num{direction:ltr; unicode-bidi:plaintext; font-variant-numeric:tabular-nums}

.p1{background:var(--p1)} .p2{background:var(--p2)} .sum{background:var(--sum)} .avg{background:var(--avg)} .final{background:var(--final)} .total{background:var(--total)}

.mark-btn{width:26px;height:26px;border-radius:6px;border:1px solid #111;display:inline-grid;place-items:center;font-weight:900;cursor:pointer}
.mark-btn.ok{background:#dcfce7;border-color:#16a34a} .mark-btn.bad{background:#fee2e2;border-color:#ef4444} .mark-btn.neu{background:#fff}
.no-print{}

@media print{
  body{background:#fff}
  .no-print{display:none!important}
  .layout{display:block; padding:0}
  #printArea{transform:scale(var(--printScale)); transform-origin: top left}
  .wrapX{overflow:visible!important}
  table{min-width:0!important}
}
